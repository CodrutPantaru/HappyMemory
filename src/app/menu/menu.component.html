<div class="menu-shell">
  <header class="top-header">
    <div class="profile">
      <div class="avatar-button" aria-hidden="true">
        <span class="avatar-emoji">ðŸ™‚</span>
      </div>
      <div class="welcome">
        <div class="hello">{{ i18n.t('home.hello') }}</div>
        <div class="subtitle">{{ i18n.t('home.welcome') }}</div>
      </div>
    </div>
    <div class="header-actions">
      <button
        class="icon-button"
        aria-label="Sunet"
        [class.is-off]="!soundOn"
        [attr.aria-pressed]="soundOn"
        (click)="toggleSound()"
      >
        <span class="icon">ðŸ”Š</span>
      </button>
      <button
        class="icon-button"
        aria-label="Muzica"
        [class.is-off]="!musicOn"
        [attr.aria-pressed]="musicOn"
        (click)="toggleMusic()"
      >
        <span class="icon">ðŸŽµ</span>
      </button>
    </div>
  </header>

  <main class="page-content">
    <img class="logo-float" src="assets/logo.webp" alt="{{ i18n.t('app.title') }}" />

<div class="home-content">
    <section class="action-card">
      <button class="primary jumbo full" type="button" (click)="startGame()" aria-label="Start joc">
        {{ i18n.t('home.start') }}
      </button>
      <button class="active-pack" type="button" (click)="goToPackConfig()" aria-label="Pachet activ">
        <div class="active-pack-label">{{ i18n.t('home.activePack') }}</div>
        <div class="active-pack-content">
          <img class="active-pack-image" [src]="activeCategory.imageUrl" [alt]="i18n.t(activeCategory.labelKey)" />
          <div class="active-pack-meta">
            <div class="active-pack-name">{{ activePacksLabel }}</div>
            <div class="active-pack-difficulty">
              {{ i18n.t('settings.difficulty') }}: {{ difficultyLabel }}
            </div>
          </div>
        </div>
      </button>
      <div class="settings-spacer"></div>
      <button class="secondary settings-btn" type="button" (click)="openDifficultyModal()" aria-label="Dificultate">
        <span class="icon">ðŸŽ¯</span>
        {{ i18n.t('settings.difficulty') }}
      </button>
      <button
        class="language-flag"
        type="button"
        (click)="openLanguageModal()"
        [attr.aria-label]="i18n.t('home.language')"
      >
        {{ currentLanguageFlag }}
      </button>
    </section>
  </div>
  </main>

  <footer class="bottom-footer" aria-hidden="true"></footer>
  <div class="ad-container" aria-hidden="true"></div>
</div>

@if (openLanguage) {
  <div class="sheet-backdrop" (click)="closeLanguageModal()" aria-label="Inchide limba"></div>
  <div class="language-popover" [class.closing]="isLanguageClosing" role="dialog" aria-modal="true">
    <div class="sheet-header">
      <div class="sheet-title">{{ i18n.t('home.language') }}</div>
      <button class="sheet-close" type="button" (click)="closeLanguageModal()" aria-label="Inchide">
        {{ i18n.t('settings.close') }}
      </button>
    </div>
    <div class="language-grid">
      @for (lang of languages; track lang) {
        <button
          class="chip"
          [class.active]="i18n.language === lang.id"
          (click)="setLanguage(lang.id); closeLanguageModal()"
          [attr.aria-pressed]="i18n.language === lang.id"
          [attr.aria-label]="lang.label"
        >
          <span class="flag">{{ languageFlag(lang.id) }}</span>
          <span>{{ lang.label }}</span>
        </button>
      }
    </div>
  </div>
}

@if (isDifficultyOpen) {
  <div class="sheet-backdrop" (click)="closeDifficultyModal()" aria-label="Inchide dificultate"></div>
  <div class="difficulty-modal" role="dialog" aria-modal="true">
    <div class="sheet-header">
      <div class="sheet-title">{{ i18n.t('settings.difficulty') }}</div>
      <button class="sheet-close" type="button" (click)="closeDifficultyModal()">
        {{ i18n.t('settings.close') }}
      </button>
    </div>
    <div class="sheet-section">
      <div class="sheet-label">{{ i18n.t('settings.matchSize') }}</div>
      <div class="choice-row">
        @for (size of matchSizes; track size) {
          <button
            class="chip"
            [class.active]="selectedMatchSize === size"
            (click)="setMatchSize(size)"
            [attr.aria-pressed]="selectedMatchSize === size"
          >
            {{ matchSizeLabel(size) }}
          </button>
        }
      </div>
    </div>
    <div class="sheet-section">
      <div class="sheet-label">{{ i18n.t('settings.grid') }}</div>
      <div class="choice-row">
        @for (option of gridOptions; track option.id) {
          <button
            class="chip"
            [class.active]="selectedGridId === option.id"
            (click)="setGrid(option.id)"
            [attr.aria-pressed]="selectedGridId === option.id"
          >
            {{ option.label }}
          </button>
        }
      </div>
    </div>
    <button class="primary sheet-save" type="button" (click)="saveDifficulty()">
      {{ i18n.t('settings.save') }}
    </button>
  </div>
}
